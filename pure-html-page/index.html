<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pure HTML Example</title>
    <style>
      html {
        background-color: #fff;
      }
    </style>
    <script type="module">

      // LP:  1. Import Bridge class from `https://unpkg.com/@dapplets/dapplet-overlay-bridge` pachage
      import Bridge from 'https://unpkg.com/@dapplets/dapplet-overlay-bridge';
      // LP end

      // LP:  2. Create Bridge class instance and subscribe for the `data` event.
      const bridge = new Bridge();

      bridge.on('data', ({ message, counter }) => {
        console.log('data')
        document.querySelector('.dappletMessage').innerText = message;
        document.querySelector('.dappletCounter').innerText = counter ?? 0;
      });
      // LP end

      // LP:  3. Add an event on the button click
      let isTick = true;
      const button = document.querySelector('.ch-state-btn');

      button.addEventListener('click', async () => {
        const counter = await bridge.increaseCounterAndToggleLabel(isTick);
        document.querySelector('.dappletCounter').innerText = counter;
        isTick = !isTick;
      });
      // LP end
    </script>
  </head>

  <body>
    <h1>Overlay with JavaScript</h1>
    <p>Message from the dapplet: <span class="dappletMessage"></span></p>
    <p>Counter: <span class="dappletCounter"></span></p>
    <button class="ch-state-btn">Counter +1</button>
  </body>
</html>
